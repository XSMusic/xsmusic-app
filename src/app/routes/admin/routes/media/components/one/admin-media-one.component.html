<form @inOut class="grid grid-cols-1 gap-4 lg:grid-cols-2">
  <div class="col-span-2 mb-1 md:col-span-1">
    <img
      [src]="media.image"
      [alt]="media.name"
      (click)="showImage(media.image!)"
      class="object-cover w-full rounded-lg cursor-pointer h-80"
      onError
    />
  </div>
  <div class="grid grid-cols-2 gap-4">
    <div class="col-span-2 md:col-span-1">
      <label for="name" class="block mb-3 text-base font-extrabold text-black">
        Nombre
      </label>
      <input
        name="name"
        type="text"
        [(ngModel)]="media.name"
        placeholder="Introduce el nombre"
        class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md"
      />
    </div>

    <div class="col-span-2 md:col-span-1">
      <label
        for="source"
        class="block mb-3 text-base font-extrabold text-black"
      >
        Medio
      </label>
      <select
        name="source"
        type="text"
        [(ngModel)]="media.source"
        placeholder="Selecciona el medio"
        class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md"
      >
        <option [value]="null" [disabled]="true" [selected]>
          Selecciona medio
        </option>
        <option *ngFor="let source of sources" [value]="source.value">
          {{ source.name }}
        </option>
      </select>
    </div>

    <div class="col-span-2 mb-1 md:col-span-2">
      <label
        for="sourceId"
        class="block mb-3 text-base font-extrabold text-black"
      >
        Video Id
      </label>
      <input
        name="sourceId"
        type="text"
        [(ngModel)]="media.sourceId"
        placeholder="Introduce el id del video"
        class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md"
      />
    </div>

    <div class="col-span-2 mb-1 md:col-span-2">
      <label
        for="sourceId"
        class="block mb-3 text-base font-extrabold text-black"
      >
        Año
      </label>
      <input
        name="year"
        type="number"
        [(ngModel)]="media.year"
        placeholder="Introduce el año"
        class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md"
      />
    </div>
  </div>

  <div class="col-span-2 mb-1 md:col-span-1">
    <label class="block mb-3 text-base font-extrabold text-black">
      <span class="text-gray-700">Artista/s</span>
    </label>
    <div class="flex gap-2 my-3">
      <div
        (click)="onClickItem('artists', artistSelected)"
        class="flex px-2 py-1 text-xs text-white bg-black border rounded-lg shadow-md cursor-pointer hover:opacity-80"
        *ngFor="let artistSelected of media.artists"
      >
        <img
          [src]="artistSelected.image"
          alt="artistSelected.name"
          class="w-5 h-5 mr-3 rounded-full"
          onError
        />
        <span class="pr-1 text-sm font-medium">{{ artistSelected.name }}</span>
      </div>
    </div>
    <input
      (click)="closeSelection('artists')"
      name="artist"
      (keydown.enter)="$event.preventDefault(); onChangeInputArtist($event)"
      [(ngModel)]="artistSearch"
      placeholder="Introduce el artista"
      class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md cursor-pointer"
      autocomplete="off"
    />

    <div
      @inOut
      class="absolute z-10 w-48 mt-1 bg-white border rounded-lg shadow-lg"
      *ngIf="selectArtistsState"
    >
      <div
        class="flex px-3 py-2 border-b cursor-pointer hover:bg-gray-200"
        *ngFor="let artistS of artistsSearch"
        (click)="onSelectArtist(artistS)"
      >
        <img
          [src]="artistS.image"
          alt=""
          class="w-10 h-10 mr-3 rounded-full"
          onError
        />
        <div class="flex flex-col">
          <span class="text-sm font-medium">{{ artistS?.name }}</span>
          <span class="text-sm font-light">
            {{ artistS?.country ?? 'es' | countryName }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- SITE -->

  <div class="col-span-2 mb-1 md:col-span-1" *ngIf="media.type === 'set'">
    <label class="block mb-3 text-base font-extrabold text-black">
      <span class="text-gray-700">Club/Festival</span>
    </label>
    <div class="flex gap-2 my-3" *ngIf="media.site">
      <div
        class="flex px-2 py-1 text-xs text-white bg-black border rounded-lg shadow-md cursor-pointer hover:opacity-80"
      >
        <img
          [src]="media.site?.image"
          [alt]=""
          class="w-5 h-5 mr-3 rounded-full"
          onError
        />
        <span class="pr-1 text-sm font-medium">{{ media.site?.name }}</span>
      </div>
    </div>

    <input
      (click)="closeSelection('sites')"
      name="site"
      (keydown.enter)="$event.preventDefault(); onChangeInputSite($event)"
      [(ngModel)]="siteSearch"
      placeholder="Introduce el club/festival"
      class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md cursor-pointer"
      autocomplete="off"
    />

    <div
      @inOut
      class="absolute z-10 w-48 mt-1 bg-white border rounded-lg shadow-lg"
      *ngIf="selectSitesState"
    >
      <div
        class="flex px-3 py-2 border-b cursor-pointer hover:bg-gray-200"
        *ngFor="let site of sitesSearch | slice: 0:5"
        (click)="onSelectSite(site)"
      >
        <img
          [src]="site.image"
          alt=""
          class="w-10 h-10 mr-3 rounded-full"
          onError
        />
        <div class="flex flex-col">
          <span class="text-sm font-medium">{{ site.name }}</span>
          <span class="text-sm font-light">
            {{ site.address.country! | countryName }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- ESTILOS -->

  <div
    class="col-span-2 mb-1"
    [ngClass]="{
      'md:col-span-1': media.type === 'track',
      'md:col-span-2': media.type === 'set'
    }"
  >
    <label class="block mb-3 text-base font-extrabold text-black">
      <span class="text-gray-700">Estilo/s</span>
    </label>
    <div class="flex gap-2 my-3">
      <span
        (click)="onClickItem('styles', styleSelected)"
        class="px-2 py-1 text-xs bg-gray-100 border rounded-lg shadow-md cursor-pointer"
        *ngFor="let styleSelected of media.styles"
        [ngStyle]="{
          background: styleSelected.colors.bg,
          color: styleSelected.colors.text
        }"
      >
        <span class="pr-1 text-sm font-medium">{{ styleSelected.name }}</span>
      </span>
    </div>
    <select
      class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md form-multiselect"
      (change)="onChangeStyleSelect($event)"
    >
      <option [disabled]="true">Selecciona estilo</option>
      <option *ngFor="let style of styles" [value]="style._id">
        {{ style.name }}
      </option>
    </select>
  </div>

  <div class="col-span-2 mb-1 md:col-span-2">
    <label
      for="sourceId"
      class="block mb-3 text-base font-extrabold text-black"
    >
      Info
    </label>
    <textarea
      name="info"
      [(ngModel)]="media.info"
      placeholder="Introduce informacion"
      class="w-full px-6 text-base font-medium bg-white border border-gray-200 rounded-md"
    ></textarea>
  </div>

  <!-- Actions Buttons -->
  <div class="col-span-2 mb-2">
    <button
      type="submit"
      (click)="onSubmit()"
      class="w-full py-1 m-1 text-white bg-green-500 border-green-500 rounded-lg shadow-md md:w-32 hover:bg-green-600 hover:border-green-600'"
    >
      Guardar
    </button>
    <button
      type="button"
      *ngIf="media._id"
      (click)="onDelete()"
      class="w-full py-1 m-1 text-white bg-red-500 border-2 border-red-500 rounded-lg shadow-md hover:bg-red-600 hover:border-red-600 hover:text-white md:w-32"
    >
      Eliminar
    </button>

    <button
      type="button"
      *ngIf="media._id"
      (click)="goToMedia(media.slug!)"
      class="w-full py-1 m-1 text-white bg-blue-500 border-2 border-blue-500 rounded-lg shadow-md hover:bg-blue-600 hover:border-blue-600 hover:text-white md:w-32"
    >
      Ver perfil
    </button>
  </div>
</form>
