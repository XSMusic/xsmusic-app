<ng-container *ngIf="!loading">
  <ng-container *ngIf="items.length > 0">
    <div @inOut class="my-2 overflow-x-auto">
      <table class="w-full whitespace-nowrap" aria-label="artist">
        <tbody>
          <tr
            *ngFor="let item of items"
            class="h-16 border-b border-gray-100 rounded-lg dark:border-black dark:border-0"
          >
            <td class="pl-3">
              <div class="flex gap-3 max-w-80">
                <div class="w-12">
                  <img
                    [src]="item.images! | imageArray"
                    [alt]="item.name"
                    onError
                    class="object-cover object-center w-full h-12 cursor-pointer rounded-2xl hover:filter-grayscale hover:scale-105 hover:duration-1000"
                    (click)="showImage(item.images![0].url ?? '')"
                  />
                </div>
                <div class="flex flex-col">
                  <p
                    class="my-1 mr-2 text-lg font-extrabold leading-none text-black cursor-pointer dark:text-white hover:text-gray-600"
                    (click)="goToProfile.emit({ type: 'event', event: item })"
                  >
                    {{ item.name }}
                  </p>
                  <div class="flex gap-1">
                  <p
                    *ngFor="let artist of item.artists! | slice:0:3; let i = index"
                    class="text-sm dark:text-gray-400"
                  >
                  <span *ngIf="i !== 0"> & </span>
                    {{ artist.name }}
                  </p>
                  </div>
                </div>
              </div>
            </td>

            <td class="pl-3">
              <div
                class="flex gap-3 w-60"
                *ngIf="item.site.name !== 'Desconocido'"
              >
                <img
                  [src]="item.site.images | imageArray"
                  alt=""
                  class="object-cover object-center rounded-lg cursor-pointer h-9 w-9 hover:filter-grayscale hover:scale-110 hover:duration-1000"
                  (click)="showImage(item.site.image!)"
                  onError
                />
                <div class="flex flex-col">
                  <p
                    class="my-0.5 mr-2 text-base font-bold leading-none text-black dark:text-white cursor-pointer hover:text-gray-600"
                    (click)="goToProfile.emit({ type: 'site', event: item })"
                  >
                    {{ item.site.name }}
                  </p>
                  <div
                    *ngIf="item.site"
                    class="flex gap-1 text-sm font-light text-gray-400 cursor-pointer"
                  >
                    <img
                      [src]="
                        item.site.address.country
                          ? (item.site.address.country | countryFlag)
                          : ('es' | countryFlag)
                      "
                      [alt]="item.site.address.country"
                      class="w-3 h-3 my-1 cursor-pointer hover:scale-110 hover:duration-1000"
                    />
                    {{ item.site.address?.country ?? 'es' | countryName }}
                  </div>
                </div>
              </div>
            </td>

            <td class="pl-3">
              <div class="flex gap-2">
                <span
                  *ngFor="let style of item.styles; let i = index"
                  class="px-2 py-1 text-xs text-center bg-gray-100 shadow-md cursor-pointer rounded-2xl hover:bg-gray-200"
                  (click)="filter.emit({ name: 'styles', value: style.name })"
                >
                  {{ style.name | titlecase }}
                </span>
              </div>
            </td>

            <td class="px-5" class="dark:text-white">
              <div class="flex flex-col gap-2 text-center">
                <div class="mr-2 text-sm font-light leading-none text-gray-700 dark:text-gray-400">
                  {{ item.date! | momentFormat: 'DD-MM-YY' }}
                </div>
                <div class="mr-2 text-sm font-light leading-none text-gray-700 dark:text-gray-400">
                  {{ item.date! | momentFormat: 'HH:mm' }}
                </div>
              </div>
            </td>

            <td class="pl-5" *ngxPermissionsOnly="'ADMIN'">
              <div class="flex flex-col">
                <div class="mr-2 text-sm font-light leading-none text-gray-700 dark:text-gray-400">
                  <span class="font-extrabold dark:text-white">Cre:</span>
                  {{ item.created! | timeAgo }}
                </div>
                <div class="mr-2 text-sm font-light leading-none text-gray-700 dark:text-gray-400">
                  <span class="font-extrabold dark:text-white">Act:</span>
                  {{ item.updated! | timeAgo }}
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div
      class="search-results"
      infiniteScroll
      [infiniteScrollDistance]="2"
      [infiniteScrollThrottle]="50"
      (scrolled)="onScroll.emit()"
    ></div>
  </ng-container>

  <div class="mt-1" *ngIf="items.length === 0">
    <alert
      type="warning"
      message="No hay eventos disponibles"
      actionText="Quitar"
    ></alert>
  </div>
</ng-container>

<ng-container *ngIf="loading">
  <div class="w-full py-2">
    <div
      *ngFor="let artist of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]"
      class="relative h-24 my-4 overflow-hidden bg-gray-100 shadow-xl cursor-pointer dark:bg-gray-900 animate-pulse"
    ></div>
  </div>
</ng-container>
